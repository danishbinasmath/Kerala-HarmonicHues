{"version":3,"file":"index.js","sources":["../src/helpers/observable.js","../src/store.js","../src/connect.js","../src/helpers/store.js"],"sourcesContent":["class Observable {\n  constructor() {\n    this.observers = []\n    this.data = null\n  }\n\n  subscribe(fn) {\n    this.observers.push(fn)\n  }\n\n  unsubscribe(fn) {\n    this.observers = this.observers.filter((f) => f !== fn)\n  }\n\n  getData() {\n    return this.data\n  }\n\n  notify(data) {\n    this.data = data\n    this.observers.forEach((fn) => {\n      if (typeof fn === 'function') {\n        fn(data)\n      }\n    })\n  }\n}\n\nexport default Observable\n","import Observable from './helpers/observable'\n\nclass Store {\n  constructor() {\n    this.store = {}\n  }\n\n  addStore(storeName) {\n    this.store[storeName] = {}\n  }\n\n  addNode(storeName, nodeName) {\n    if (!this.store[storeName]) throw new Error('No store found')\n    this.store[storeName][nodeName] = new Observable()\n  }\n\n  setStore(storeName, nodeName, data) {\n    if (!this.store[storeName] || !this.store[storeName][nodeName]) throw new Error('No store found')\n    this.store[storeName][nodeName].notify(data)\n  }\n\n  getStore(storeName, nodeName) {\n    if (!this.store[storeName] || !this.store[storeName][nodeName]) throw new Error('No store found')\n    return this.store[storeName][nodeName].getData()\n  }\n\n  addListener(storeName, nodeName, fn) {\n    if (!this.store[storeName] || !this.store[storeName][nodeName]) throw new Error('No store found')\n    if (!fn || typeof fn !== 'function') throw new Error('You need to pass a valid callback function')\n    this.store[storeName][nodeName].subscribe(fn)\n  }\n\n  removeListener(storeName, nodeName, fn) {\n    if (!this.store[storeName] || !this.store[storeName][nodeName]) throw new Error('No store found')\n    if (!fn || typeof fn !== 'function') throw new Error('You need to pass a valid callback function')\n    this.store[storeName][nodeName].unsubscripe(fn)\n  }\n}\n\nconst GlobalStore = new Store()\n\nexport default GlobalStore\n","import React from 'react'\nimport GlobalStore from './store'\n\nexport function InjectStore(Component, store) {\n  return class extends React.Component {\n    constructor(props) {\n      super(props)\n      this.storeName = store.getName()\n      const state = store.getInitState() || {}\n      GlobalStore.addStore(this.storeName)\n      Object.keys(state).forEach((node) => {\n        GlobalStore.addNode(this.storeName, node)\n        GlobalStore.setStore(this.storeName, node, state[node])\n      })\n      this.on = this.on.bind(this)\n      this.onStore = this.onStore.bind(this)\n      this.getStore = this.getStore.bind(this)\n      this.setStore = this.setStore.bind(this)\n      this.listeners = []\n    }\n\n    componentWillUnmount() {\n      this.listeners.forEach((listener) => GlobalStore.removeListener(listener.store, listener.node, listener.fn))\n    }\n\n    on(nodes, fn) {\n      if (nodes) {\n        if (Array.isArray(nodes)) {\n          nodes.forEach((node) => {\n            GlobalStore.addListener(this.storeName, node, fn)\n            this.listeners.push({ store: this.storeName, node, fn })\n          })\n        } else {\n          GlobalStore.addListener(this.storeName, nodes, fn)\n          this.listeners.push({ store: this.storeName, nodes, fn })\n        }\n      }\n    }\n\n    onStore(store, nodes, fn) {\n      if (store && nodes) {\n        const storeName = store.getName()\n        if (Array.isArray(nodes)) {\n          nodes.forEach((node) => {\n            GlobalStore.addListener(storeName, node, fn)\n            this.listeners.push({ store: storeName, node, fn })\n          })\n        } else {\n          GlobalStore.addListener(storeName, nodes, fn)\n          this.listeners.push({ store: storeName, nodes, fn })\n        }\n      }\n    }\n\n    getStore(store, nodeName) {\n      const storeName = store.getName()\n      return GlobalStore.getStore(storeName, nodeName)\n    }\n\n    setStore(store, nodeName, data) {\n      const storeName = store.getName()\n      GlobalStore.setStore(storeName, nodeName, data)\n    }\n\n    render() {\n      return <Component on={this.on} onStore={this.onStore} getStore={this.getStore} setStore={this.setStore} />\n    }\n  }\n}\n","export class Store {\n  constructor(name, initState) {\n    this.setName(name)\n    this.setInitState(initState)\n  }\n\n  setName(name) {\n    this.name = name\n  }\n\n  getName() {\n    return this.name\n  }\n\n  setInitState(initState) {\n    if (!initState || typeof initState !== 'object') throw new Error('unspported type')\n    this.initState = initState\n  }\n\n  getInitState() {\n    return this.initState\n  }\n}\n"],"names":["Observable","observers","data","fn","push","filter","f","forEach","Store","store","storeName","nodeName","Error","notify","getData","subscribe","unsubscripe","GlobalStore","InjectStore","Component","props","getName","state","getInitState","addStore","keys","node","addNode","setStore","on","bind","onStore","getStore","listeners","listener","removeListener","nodes","Array","isArray","addListener","React","name","initState","setName","setInitState"],"mappings":"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"}